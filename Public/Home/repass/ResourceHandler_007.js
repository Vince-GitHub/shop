(function(a){a.fn.shortPass="太短";a.fn.badPass="弱";a.fn.goodPass="中";a.fn.strongPass="强";a.fn.samePassword="Username and Password identical.";a.fn.resultStyle="";a.fn.passStrength=function(c){var b={shortPass:"shortPass",badPass:"badPass",goodPass:"goodPass",strongPass:"strongPass",baseStyle:"testresult",userid:"",messageloc:1,wrap:null};var d=a.extend(b,c);return this.each(function(){var e=a(this);a(e).on("keyup",function(){var f;if(d.wrap){f=a(this).closest(d.wrap)}else{f=a(this)}var g=a.fn.teststrength(a(this).val(),a(d.userid).val(),d);if(d.messageloc===1){f.next("."+d.baseStyle).remove();f.after('<div class="'+d.baseStyle+'"><div class="inlb"></div></div>');f.next("."+d.baseStyle).addClass(a(this).resultStyle).find("div").text(g)}else{f.prev("."+d.baseStyle).remove();f.before('<div class="'+d.baseStyle+'"><div class="inlb"></div></div>');f.prev("."+d.baseStyle).addClass(a(this).resultStyle).find("div").text(g)}});a.fn.teststrength=function(g,i,f){var h=0;h+=g.length*4;h+=(a.fn.checkRepetition(1,g).length-g.length)*1;h+=(a.fn.checkRepetition(2,g).length-g.length)*1;h+=(a.fn.checkRepetition(3,g).length-g.length)*1;h+=(a.fn.checkRepetition(4,g).length-g.length)*1;if(g.match(/(.*[0-9].*[0-9].*[0-9])/)){h+=5}if(g.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)){h+=5}if(g.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){h+=10}if(g.match(/([a-zA-Z])/)&&g.match(/([0-9])/)){h+=15}if(g.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&g.match(/([0-9])/)){h+=15}if(g.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&g.match(/([a-zA-Z])/)){h+=15}if(g.match(/^\w+$/)||g.match(/^\d+$/)){h-=10}if(h<0){h=0}if(h>100){h=100}if(h<43){this.resultStyle=f.badPass;return a(this).badPass}if(h<100){this.resultStyle=f.goodPass;return a(this).goodPass}this.resultStyle=f.strongPass;return a(this).strongPass}})}})(jQuery);$.fn.checkRepetition=function(c,f){var e="";for(var a=0;a<f.length;a++){var d=true;for(var b=0;b<c&&(b+a+c)<f.length;b++){d=d&&(f.charAt(b+a)==f.charAt(b+a+c))}if(b<c){d=false}if(d){a+=c-1;d=false}else{e+=f.charAt(a)}}return e};