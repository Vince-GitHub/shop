$("#forget_paypass").on("click",function(c){var f="";var a="";var b="";if($("#NewShangpinDomainUrl").length>0){b=$("#NewShangpinDomainUrl").val()}if($("#NewShangpinLoginDomainUrl").length>0){f=$("#NewShangpinLoginDomainUrl").val()}if($("#NewShangpinAccountDomainUrl").length>0){a=$("#NewShangpinAccountDomainUrl").val()}var d=$(this).attr("id"),g="",h="";$.ajax({type:"POST",dataType:"JSONP",jsonp:"callback",url:a+"/account/GetMobile",cache:false,success:function(e){if(e.Success=="1"){h=e.Message.toString().substring(3,7);g=e.Message.toString().replace(h,"****")}forgetPaypass(d,g)}});c.preventDefault()});function forgetPaypass(e,g){var b=e,h='<a href="javascript:;" id="paypassbtn" class="spOrder_window_submit activeComm_btns">确定</a>',i='<ul id="f-paypsdbox"><li class="ac_red txtcenter" id="forgetPassNotice"></li><li>您绑定的手机： <span id="f-phone">'+g+'</span><input type="button" class="resendBtn" id="getTestCode" value="发送验证码" /></li><li>请输入短信验证码：<input type="text" name="" class="normal-input" id="f-testcode" /></li><li>请设置新支付密码：<input type="password" name="" class="normal-input" id="f-newpaypsd" /></li><li>请再次确认新密码：<input type="password" name="" class="normal-input" id="f-newrepsd" /></li></ul>';var f="";var a="";var c="";if($("#NewShangpinDomainUrl").length>0){c=$("#NewShangpinDomainUrl").val()}if($("#NewShangpinLoginDomainUrl").length>0){f=$("#NewShangpinLoginDomainUrl").val()}if($("#NewShangpinAccountDomainUrl").length>0){a=$("#NewShangpinAccountDomainUrl").val()}var d=spWindow({id:"window_"+b,style:{wrapper:{width:"480px"},content:{"font-size":"12px"}},title:"忘记支付密码",content:i,bottom:h,closeBtn:".spOrder_window_delbtn, .title_closeBtn",titleColse:true,backover:true,binder:function(){var k=$("#window_"+b),l=k.find("#f-newpaypsd"),m=k.find("#f-newrepsd"),j=k.find("#forgetPassNotice");k.delegate("#getTestCode","click",function(){$.ajax({type:"POST",dataType:"JSONP",jsonp:"callback",url:a+"/account/SendPayVerifyCode",data:{ran:Math.random()},success:function(p){if(p.Success=="0"){alert(p.Message)}}});var o=60,n=null;$("#getTestCode").show(0,function(){var p=$(this);p.prop("disabled",true);p.val(""+o+"s后重新获取");clearInterval(n);n=null;p.val(""+o+"s后重新获取");n=setInterval(function(){o--;p.val(""+o+"s后重新获取");if(o<0){clearInterval(n);n=null;p.val("获取验证码");p.prop("disabled",false)}},1000)})});k.delegate("#paypassbtn","click",function(){var n=$("#f-testcode").val(),o=l.val().length,p=m.val().length,q=l.val();passVal2=m.val();if(n.length==0){j.html("请填写验证码")}else{if(o==0||p==0){j.html("请填写密码！")}else{if(o<6||p<6){j.html("密码最少6位")}else{if(o>20||p>20){j.html("请您输入6~20位密码！")}else{if(q==passVal2){$.ajax({type:"POST",dataType:"JSONP",jsonp:"callback",url:a+"/account/UpdatePayPassword",data:{verifyCode:n,paynewpsd:q,ran:Math.random()},success:function(r){if(r.Success=="1"){d.close();j.html(r.Message)}else{j.html(r.Message)}}})}else{if(q!==passVal2){j.html("两次密码不一致")}}}}}}return false})}}).show(function(){$("#forgetPassNotice").html("");$("#f-newpaypsd,#f-newrepsd").val("");$("#f-newpaypsd").MXCodeValClear();$("#f-newrepsd").MXCodeValClear()})};